<svg xmlns:ev="http://www.w3.org/2001/xml-events" xmlns="http://www.w3.org/2000/svg" height="826" xmlns:xlink="http://www.w3.org/1999/xlink" width="928" viewBox="0 0 928 826"><style type="text/css"><![CDATA[
.st2 {fill:#aa8736;font-family:宋体;font-size:10pt}
.st1 {fill:#ffffff;font-family:宋体;font-size:10pt}
]]></style><defs/><g id="page1" transform="translate(5,5)"><rect fill="#ffffff" x="0" height="816" width="918" y="0" stroke="#808080"/><g transform="translate(40,41)"><g id="shape1"><path fill="#459867" d="M0,0L94,0L94,34L0,34L0,0z" stroke="#476482"/><text class="st1"><tspan x="26.4" y="13.8">cloud-</tspan><tspan x="12.4" y="28.8">hypervisor</tspan></text></g><path fill="none" id="shape2" d="M47,34L47,737L47,34z" stroke="#476482"/></g><g transform="translate(205,41)"><g id="shape3"><path fill="#459867" d="M0,0L94,0L94,34L0,34L0,0z" stroke="#476482"/><text class="st1"><tspan x="12.4" y="21.3">hypervisor</tspan></text></g><path fill="none" id="shape4" d="M47,34L47,737L47,34z" stroke="#476482"/></g><g transform="translate(404,41)"><g id="shape5"><path fill="#459867" d="M0,0L94,0L94,34L0,34L0,0z" stroke="#476482"/><text class="st1"><tspan x="33.4" y="21.3">ACPI</tspan></text></g><path fill="none" id="shape6" d="M47,34L47,737L47,34z" stroke="#476482"/></g><g transform="translate(597,41)"><g id="shape7"><path fill="#459867" d="M0,0L94,0L94,34L0,34L0,0z" stroke="#476482"/><text class="st1"><tspan x="22.4" y="21.3">GuestOS</tspan></text></g><path fill="none" id="shape8" d="M47,34L47,737L47,34z" stroke="#476482"/></g><g id="shape9" transform="translate(40,107)"><path fill="#216993" d="M18,36L76,36C85.9,36,94,27.9,94,18C94,8.1,85.9,0,76,0L18,0C8.1,-0,0,8.1,0,18C-0,27.9,8.1,36,18,36z" stroke="#216993"/><text class="st1"><tspan x="26" y="15">memory</tspan><tspan x="23" y="30">hotplug</tspan></text></g><g id="shape10" transform="translate(134,125)"><path fill="none" d="M0,0L502,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M502,-4L510,0L502,4L502,-4" stroke="#000000"/></g><g transform="translate(281,102)"><path fill="none" id="shape11" d="M70.5,23M70.5,23M70.5,23M70.5,23M70.5,23M70.5,23M70.5,23M70.5,23" stroke="#ffd88f"/><g id="shape12"><path fill="#fff6e9" d="M0,0L0,46L141,46L141,13.4L121.2,0L0,0z"/><path fill="none" d="M0,0L0,46L141,46L141,13.4L121.2,0L0,0zM141,13.4L121.2,13.4L121.2,0" stroke="#ffd88f"/><text class="st2"><tspan x="16" y="20">GED Device发送中</tspan><tspan x="9" y="35">断， 通知设备热添加</tspan></text></g></g><g id="shape13" transform="translate(644,175)"><path fill="none" d="M0,0L-185,-1" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M-185,3L-193,-1L-185,-5L-185,3" stroke="#000000"/></g><g id="shape14" transform="translate(329,189.1)"><path fill="#216993" d="M36.8,73.5L204.3,73.5C224.5,73.5,241,57,241,36.8C241,16.5,224.5,0,204.3,0L36.8,0C16.5,-0,0,16.5,0,36.7C-0,57,16.5,73.5,36.8,73.5z" stroke="#216993"/><text class="st1"><tspan x="29" y="11.3">执行GED Object中的_EVT方法:</tspan><tspan x="11" y="26.3">①判断热添加设备类型，CPU/Memory/</tspan><tspan x="96" y="41.3">PCI-dev</tspan><tspan x="29" y="56.3">② 调用\\_SB_.CPUS.CSDN或者</tspan><tspan x="65" y="71.3">\\_SB_/MHPC.MSDN</tspan></text></g><g id="shape15" transform="translate(330,288.5)"><path fill="#216993" d="M59.3,122.5L177.8,122.5C210.8,121.4,237,94.3,237,61.3C237,28.2,210.8,1.1,177.8,0L59.3,0C26.2,1.1,0,28.2,0,61.2C0,94.3,26.2,121.4,59.3,122.5z" stroke="#216993"/><text class="st1"><tspan x="33" y="20.8">执行Mem Object中的MSDN():</tspan><tspan x="18" y="35.8">loop：                       </tspan><tspan x="22" y="50.8">① 设置MSEL（当前选中的slot）</tspan><tspan x="61" y="65.8">② 读取MINS、MREV</tspan><tspan x="24" y="80.8">③ 如果需要添加或者删除。调用</tspan><tspan x="59" y="95.8">MTFY(arg = 1 / 3)</tspan><tspan x="21" y="110.8">④： 设置MINS/MREV,即清空flag</tspan></text></g><g id="shape16" transform="translate(389.25,262.6)"><path fill="none" d="M0,0L0,17.9" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M4,17.9L0,25.9L-4,17.9L4,17.9" stroke="#000000"/></g><g id="shape17" transform="translate(567,349.75)"><path fill="none" d="M0,0L69,.2" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M69,-3.8L77,.3L69,4.2L69,-3.8" stroke="#000000"/></g><g transform="translate(654,315.75)"><path fill="none" id="shape18" d="M113,34.5M113,34.5M113,34.5M113,34.5M113,34.5M113,34.5M113,34.5M113,34.5" stroke="#ffd88f"/><g id="shape19"><path fill="#fff6e9" d="M0,0L0,69L226,69L226,20.1L194.3,0L0,0z"/><path fill="none" d="M0,0L0,69L226,69L226,20.1L194.3,0L0,0zM226,20.1L194.3,20.1L194.3,0" stroke="#ffd88f"/><text class="st2"><tspan x="87" y="16.5">//热添加</tspan><tspan x="15" y="31.5">ACPI_NOTIFY_DEVICE_CHECK = 1</tspan><tspan x="90" y="46.5">// 删除</tspan><tspan x="12" y="61.5">ACPI_NOTIFY_EJECT_REQUEST = 3</tspan></text></g></g><g id="shape20" transform="translate(533,415)"><path fill="#216993" d="M49.5,99L172.5,99C199.8,99,222,76.8,222,49.5C222,22.2,199.8,-0,172.5,0L49.5,0C22.2,-0,-0,22.2,-0,49.5C-0,76.8,22.2,99,49.5,99z" stroke="#216993"/><text class="st1"><tspan x="35" y="16.5">在GuestOS中最终会调用到</tspan><tspan x="31" y="31.5">acpi_memory_device_add,</tspan><tspan x="30" y="61.5">遍历该设备的_CRS(current </tspan><tspan x="29" y="76.5">resource),进而调用MCRS()</tspan></text></g><g id="shape21" transform="translate(644,525)"><path fill="none" d="M0,0L-185,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M-185,4L-193,0L-185,-4L-185,4" stroke="#000000"/></g><g id="shape22" transform="translate(340,552.5)"><path fill="#216993" d="M22.3,44.5L199.8,44.5C212,44.5,222,34.5,222,22.3C222,10,212,0,199.8,0L22.3,0C10,-0,0,10,0,22.2C-0,34.5,10,44.5,22.3,44.5z" stroke="#216993"/><text class="st1"><tspan x="52" y="19.3">MCRS(UID) Method:</tspan><tspan x="10" y="34.3">读取该设备的内存地址和长度,返回</tspan></text></g><g id="shape23" transform="translate(562,574.75)"><path fill="none" d="M0,0L74,.2" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M74,-3.8L82,.3L74,4.2L74,-3.8" stroke="#000000"/></g><g id="shape24" transform="translate(561,598)"><path fill="#216993" d="M21,42L142,42C153.6,42,163,32.6,163,21C163,9.4,153.6,0,142,0L21,0C9.4,-0,0,9.4,0,21C-0,32.6,9.4,42,21,42z" stroke="#216993"/><text class="st1"><tspan x="16" y="18">检查设备状态，_STA方</tspan><tspan x="22" y="33">法，进而调用MSTA()</tspan></text></g><g id="shape25" transform="translate(644,650)"><path fill="none" d="M0,0L-185,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M-185,4L-193,0L-185,-4L-185,4" stroke="#000000"/></g><g id="shape26" transform="translate(338,666.5)"><path fill="#216993" d="M34.3,68.5L187.8,68.5C206.7,68.5,222,53.2,222,34.3C222,15.3,206.7,0,187.8,0L34.3,0C15.3,-0,0,15.3,0,34.2C-0,53.2,15.3,68.5,34.3,68.5z" stroke="#216993"/><text class="st1"><tspan x="52" y="16.3">MSTA(UID) Method:</tspan><tspan x="43" y="31.3">设置MSEL（seleted）,</tspan><tspan x="17" y="46.3">读取MES(查看设备是否enabled)</tspan><tspan x="77" y="61.3">返回enable</tspan></text></g><g id="shape27" transform="translate(560,700.75)"><path fill="none" d="M0,0L76,-0.7" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M76,-4.7L84,-0.8L76,3.3L76,-4.7" stroke="#000000"/></g><g id="shape28" transform="translate(87,350)"><path fill="none" d="M8,0L159,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M159,-3L165,0L159,3L159,-3" stroke="#000000"/></g><g id="shape29" transform="matrix(1,-0,0,1,252,350)"><path fill="none" d="M8,0L70,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M70,-4L78,0L70,4L70,-4" stroke="#000000"/></g><g id="shape30" transform="matrix(1,-0,0,1,252,575)"><path fill="none" d="M8,0L80,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M80,-4L88,0L80,4L80,-4" stroke="#000000"/></g><g id="shape31" transform="translate(87,575)"><path fill="none" d="M8,0L159,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M159,-3L165,0L159,3L159,-3" stroke="#000000"/></g><g id="shape32" transform="translate(87,700)"><path fill="none" d="M8,0L159,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M159,-3L165,0L159,3L159,-3" stroke="#000000"/></g><g id="shape33" transform="matrix(1,-0,0,1,250,701)"><path fill="none" d="M8,0L80,0" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M8,4L0,0L8,-4L8,4" stroke="#000000"/><path fill="#000000" stroke-linecap="round" stroke-width="1" d="M80,-4L88,0L80,4L80,-4" stroke="#000000"/></g></g></svg>