<svg xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1466" height="1012" viewBox="0 0 1466 1012"><style type="text/css"><![CDATA[
.st4 {fill:#191919;font-family:宋体;font-size:10pt}
.st2 {fill:#303030;font-family:宋体;font-size:10pt}
.st3 {fill:#454545;font-family:宋体;font-size:10pt}
.st5 {fill:#454545}
.st1 {fill:#ffffff;font-family:宋体;font-size:10pt}
]]></style><defs/><g transform="translate(5,5)" id="page1"><rect x="0" y="0" width="1456" stroke="#808080" height="1002" fill="#ffffff"/><path stroke-linecap="round" transform="translate(213.26,875.03)" stroke="#696969" id="shape1" fill="none" d="M-12.5,2.2C-2,2.2,3.8,-2.2,12.5,-2.2"/><path stroke-linecap="round" transform="translate(254.01,108.53)" stroke="#696969" id="shape2" fill="none" d="M-25.1,25.3C10.7,-5.1,35.4,-51.3,90.8,-51.3"/><path stroke-linecap="round" transform="translate(254.01,177.1)" stroke="#696969" id="shape3" fill="none" d="M27.8,7C47.6,12.8,67.7,17.3,90.8,17.3"/><path stroke-linecap="round" transform="translate(623.26,237.43)" stroke="#696969" id="shape4" fill="none" d="M-12.5,-43.1C4.8,-43.1,-12.1,43.1,12.5,43.1"/><path stroke-linecap="round" transform="translate(888.26,171.9)" stroke="#696969" id="shape5" fill="none" d="M-12.5,0C-2.5,0,5,0,12.5,0"/><path stroke-linecap="round" transform="translate(1020.26,162.85)" stroke="#696969" id="shape6" fill="none" d="M-12.5,9.1C-0.4,9.1,.1,-9.1,12.5,-9.1"/><path stroke-linecap="round" transform="translate(1020.26,190)" stroke="#696969" id="shape7" fill="none" d="M-12.5,-18.1C1.5,-18.1,-4.4,18.1,12.5,18.1"/><path stroke-linecap="round" transform="translate(1194.26,144.75)" stroke="#696969" id="shape8" fill="none" d="M-12.5,9.1C-0.4,9.1,.1,-9,12.5,-9"/><path stroke-linecap="round" transform="translate(1194.26,162.85)" stroke="#696969" id="shape9" fill="none" d="M-12.5,-9C-0.4,-9,.1,9,12.5,9"/><path stroke-linecap="round" transform="translate(623.26,219.33)" stroke="#696969" id="shape10" fill="none" d="M-12.5,-25C2.8,-25,-7.4,25,12.5,25"/><path stroke-linecap="round" transform="translate(825.26,244.3)" stroke="#696969" id="shape11" fill="none" d="M-12.5,0C-2.5,0,5,0,12.5,0"/><path stroke-linecap="round" transform="translate(254.26,485.08)" stroke="#696969" id="shape12" fill="none" d="M-12.5,-6.9C-0.9,-6.9,1.2,6.9,12.5,6.9"/><path stroke-linecap="round" transform="translate(477.26,464.8)" stroke="#696969" id="shape13" fill="none" d="M-12.5,27.2C3.1,27.2,-8.2,-27.2,12.5,-27.2"/><path stroke-linecap="round" transform="translate(477.26,501)" stroke="#696969" id="shape14" fill="none" d="M-12.5,-9C-0.4,-9,.1,9,12.5,9"/><path stroke-linecap="round" transform="translate(477.26,537.2)" stroke="#696969" id="shape15" fill="none" d="M-12.5,-45.3C4.9,-45.3,-12.3,45.3,12.5,45.3"/><path stroke-linecap="round" transform="translate(477.26,519.1)" stroke="#696969" id="shape16" fill="none" d="M-12.5,-27.1C3.1,-27.1,-8.2,27.1,12.5,27.1"/><path stroke-linecap="round" transform="translate(693.26,419.55)" stroke="#696969" id="shape17" fill="none" d="M-12.5,18.1C1.5,18.1,-4.4,-18.1,12.5,-18.1"/><path stroke-linecap="round" transform="translate(693.26,437.65)" stroke="#696969" id="shape18" fill="none" d="M-12.5,0C-2.5,0,5,0,12.5,0"/><path stroke-linecap="round" transform="translate(693.26,455.75)" stroke="#696969" id="shape19" fill="none" d="M-12.5,-18.1C1.5,-18.1,-4.4,18.1,12.5,18.1"/><path stroke-linecap="round" transform="translate(213.26,920.28)" stroke="#696969" id="shape20" fill="none" d="M-12.5,-43.1C4.8,-43.1,-12.1,43.1,12.5,43.1"/><path stroke-linecap="round" transform="translate(380.26,845.7)" stroke="#696969" id="shape21" fill="none" d="M-12.5,27.1C3.1,27.1,-8.2,-27.1,12.5,-27.1"/><path stroke-linecap="round" transform="translate(380.26,863.8)" stroke="#696969" id="shape22" fill="none" d="M-12.5,9C-0.4,9,.1,-9,12.5,-9"/><path stroke-linecap="round" transform="translate(380.26,881.9)" stroke="#696969" id="shape23" fill="none" d="M-12.5,-9.1C-0.4,-9.1,.1,9.1,12.5,9.1"/><path stroke-linecap="round" transform="translate(380.26,900)" stroke="#696969" id="shape24" fill="none" d="M-12.5,-27.2C3.1,-27.2,-8.2,27.2,12.5,27.2"/><path stroke-linecap="round" transform="translate(380.26,963.35)" stroke="#696969" id="shape25" fill="none" d="M-12.5,0C-2.5,0,5,0,12.5,0"/><g transform="translate(44.76,133.85)" id="shape26"><path fill-rule="evenodd" stroke-width="3" stroke="#3f5cb8" fill="#3f5cb8" d="M4,0L233,0C235.2,0,237,1.8,237,4L237,48C237,50.2,235.2,52,233,52L4,52C1.8,52,0,50.2,0,48L0,4C0,1.8,1.8,0,4,0z"/><text class="st1"><tspan x="24.8" y="31.6">virt_machine_device_plug_cb</tspan></text></g><g transform="translate(344.76,39.2)" id="shape27"><path fill-rule="evenodd" stroke="#eaebf1" fill="#eaebf1" d="M4,0L367,0C369.2,0,371,1.8,371,4L371,32C371,34.2,369.2,36,367,36L4,36C1.8,36,0,34.2,0,32L0,4C0,1.8,1.8,0,4,0z"/><text class="st2"><tspan x="21.8" y="23.6">TYPE_SYS_BUS_DEVICE -> platform_bus_link_device</tspan></text></g><path stroke-linecap="round" transform="translate(623.26,183.13)" stroke="#696969" id="shape28" fill="none" d="M-12.5,11.2C.1,11.2,-1,-11.2,12.5,-11.2"/><g transform="translate(344.76,176.35)" id="shape29"><path fill-rule="evenodd" stroke="#eaebf1" fill="#eaebf1" d="M4,0L262,0C264.2,0,266,1.8,266,4L266,32C266,34.2,264.2,36,262,36L4,36C1.8,36,0,34.2,0,32L0,4C0,1.8,1.8,0,4,0z"/><text class="st2"><tspan x="21.8" y="23.6">TYPE_PC_DIMM -> virt_memory_plug</tspan></text></g><g transform="translate(635.76,144.4)" id="shape30"><path stroke="#696969" fill="none" d="M0,27.5L240,27.5"/><text class="st3"><tspan x="11.5" y="18.3">virt_machine_device_pre_plug_cb</tspan></text></g><g transform="translate(635.76,253)" id="shape31"><path stroke="#696969" fill="none" d="M0,27.5L107,27.5"/><text class="st3"><tspan x="11.5" y="18.3">acpi_handler</tspan></text></g><g transform="translate(900.76,144.4)" id="shape32"><path fill-rule="evenodd" fill="#6e1d1e" d="M0,0L107,0L107,27.5L0,27.5L0,0z"/><path stroke="#6e1d1e" fill="none" d="M0,27.5L107,27.5"/><text class="st1"><tspan x="11.5" y="18.3">pc_dimm_plug</tspan></text></g><g transform="translate(1032.76,126.3)" id="shape33"><path stroke="#696969" fill="none" d="M0,27.5L149,27.5"/><text class="st3"><tspan x="11.5" y="18.3">memory_device_plug</tspan></text></g><g transform="translate(1032.76,180.6)" id="shape34"><path stroke="#696969" fill="none" d="M0,27.5L163,27.5"/><text class="st3"><tspan x="11.5" y="18.3">vmstate_register_ram</tspan></text></g><g transform="translate(1206.76,108.2)" id="shape35"><path stroke="#696969" fill="none" d="M0,27.5L170,27.5"/><text class="st3"><tspan x="11.5" y="18.3">mdc.get_memory_region</tspan></text></g><g transform="translate(1206.76,144.4)" id="shape36"><path stroke="#696969" fill="none" d="M0,27.5L212,27.5"/><text class="st3"><tspan x="11.5" y="18.3">memory_region_add_subregion</tspan></text></g><g transform="translate(635.76,216.8)" id="shape37"><path stroke="#696969" fill="none" d="M0,27.5L177,27.5"/><text class="st3"><tspan x="11.5" y="18.3">if(nv_dimm)nvdimm_plug</tspan></text></g><g transform="translate(837.76,216.8)" id="shape38"><path stroke="#696969" fill="none" d="M0,27.5L184,27.5"/><text class="st3"><tspan x="11.5" y="18.3">nvdimm_build_fit_buffer</tspan></text></g><g transform="translate(52.76,460.2)" id="shape39"><path fill-rule="evenodd" stroke="#eb7a88" fill="#eb7a88" d="M4,0L185,0C187.2,0,189,1.8,189,4L189,32C189,34.2,187.2,36,185,36L4,36C1.8,36,0,34.2,0,32L0,4C0,1.8,1.8,0,4,0z"/><text class="st1"><tspan x="21.8" y="23.6">pc_machine_class_init</tspan></text></g><g transform="translate(266.76,464.45)" id="shape40"><path stroke="#696969" fill="none" d="M0,27.5L198,27.5"/><text class="st3"><tspan x="11.5" y="18.3">pc_machine_device_plug_cb</tspan></text></g><g transform="translate(489.76,410.15)" id="shape41"><path stroke="#696969" fill="none" d="M0,27.5L191,27.5"/><text class="st3"><tspan x="11.5" y="18.3">PC_DIMM->pc_memory_plug </tspan></text></g><g transform="translate(489.76,482.55)" id="shape42"><path stroke="#696969" fill="none" d="M0,27.5L184,27.5"/><text class="st3"><tspan x="11.5" y="18.3">TYPE_CPU-> x86_cpu_plug</tspan></text></g><g transform="translate(489.76,554.95)" id="shape43"><path stroke="#696969" fill="none" d="M0,27.5L156,27.5"/><text class="st3"><tspan x="11.5" y="18.3">TYPE_VIRTIO_MEM_PCI</tspan></text></g><g transform="translate(489.76,518.75)" id="shape44"><path stroke="#696969" fill="none" d="M0,27.5L163,27.5"/><text class="st3"><tspan x="11.5" y="18.3">TYPE_VIRTIO_PMEM_PCI</tspan></text></g><g transform="translate(705.76,373.95)" id="shape45"><path fill-rule="evenodd" fill="#7b3f23" d="M0,0L107,0L107,27.5L0,27.5L0,0z"/><path stroke="#7b3f23" fill="none" d="M0,27.5L107,27.5"/><text class="st1"><tspan x="11.5" y="18.3">pc_dimm_plug</tspan></text></g><g transform="translate(705.76,410.15)" id="shape46"><path stroke="#696969" fill="none" d="M0,27.5L177,27.5"/><text class="st3"><tspan x="11.5" y="18.3">if(nv_dimm)nvdimm_plug</tspan></text></g><g transform="translate(705.76,446.35)" id="shape47"><path stroke="#696969" fill="none" d="M0,27.5L163,27.5"/><text class="st3"><tspan x="11.5" y="18.3">hotplug_handler_plug</tspan></text></g><g transform="matrix(0.59,-0.81,0.81,0.59,817.5,388)" id="shape48"><path stroke-width="2" stroke-dasharray="2.5,2.5" stroke="#35609f" fill="none" d="M0,0C78.4,68.5,172.3,-63.8,250.6,-5.2"/><path stroke-linecap="round" stroke-width="1" stroke="#35609f" fill="#35609f" d="M257,0L253,-10.6L253,-10.6C252.7,-8.7,251.9,-6.8,250.6,-5.3C249.3,-3.7,247.7,-2.5,245.9,-1.8L257,0"/><text class="st4"><tspan x="125" y="4.5"> </tspan></text></g><g transform="translate(39.76,859.2)" id="shape49"><path fill-rule="evenodd" stroke="#eb7a88" fill="#eb7a88" d="M4,0L157,0C159.2,0,161,1.8,161,4L161,32C161,34.2,159.2,36,157,36L4,36C1.8,36,0,34.2,0,32L0,4C0,1.8,1.8,0,4,0z"/><text class="st1"><tspan x="21.8" y="23.6">nvdimm_build_acpi</tspan></text></g><g transform="translate(225.76,845.35)" id="shape50"><path stroke="#696969" fill="none" d="M0,27.5L142,27.5"/><text class="st1"><tspan x="11.5" y="18.3" class="st5">nvdimm_build_ssdt</tspan></text></g><g transform="translate(225.76,935.85)" id="shape51"><path stroke="#696969" fill="none" d="M0,27.5L142,27.5"/><text class="st3"><tspan x="11.5" y="18.3">nvdimm_build_nfit</tspan></text></g><g transform="translate(392.76,791.05)" id="shape52"><path stroke="#696969" fill="none" d="M0,27.5L149,27.5"/><text class="st3"><tspan x="11.5" y="18.3">common _DSM method</tspan></text></g><g transform="translate(392.76,827.25)" id="shape53"><path stroke="#696969" fill="none" d="M0,27.5L273,27.5"/><text class="st3"><tspan x="11.5" y="18.3">device _DSM method (属于root device)</tspan></text></g><g transform="translate(392.76,863.45)" id="shape54"><path stroke="#696969" fill="none" d="M0,27.5L317,27.5"/><text class="st3"><tspan x="11.5" y="18.3">nvdimm_build_fit （root设备的 '_FIT' 方法）</tspan></text></g><g transform="translate(392.76,899.65)" id="shape55"><path stroke="#696969" fill="none" d="M0,27.5L547,27.5"/><text class="st3"><tspan x="11.5" y="18.3">对于每个slot(包含热插拔),在root-device下创建NVxx设备，并包含 _ADR 和 _DSM 成员</tspan></text></g><g transform="translate(392.76,935.85)" id="shape56"><path stroke="#696969" fill="none" d="M0,27.5L505,27.5"/><text class="st3"><tspan x="11.5" y="18.3">NVDIMMState中保存的fit_buf(类型 NvdimmFitBuffer)字节流直接保存在table中</tspan></text></g></g></svg>